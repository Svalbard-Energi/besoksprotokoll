import{c as U,a as C,f as W}from"./YZ5Zo5Xd.js";import{i as nt}from"./BiU8bGry.js";import{h as te,P as Wt,b as Vt,y as w,aw as Bt,aq as Xt,R as jt,Y as Ye,W as we,a7 as ve,f as ue,Q as Kt,ac as Pt,V as Fe,c as Qt,e as xe,s as Yt,aa as ot,aE as Ft,a as ke,am as Jt,M as Je,aP as lt,aQ as ct,aR as Zt,r as ut,p as es,aS as be,a5 as ts,aT as ss,aU as is,a9 as rs,d as as,a3 as ns,aV as ht,I as os,aW as ls,ax as F,u as A,aj as Q,an as J,g as X,K as $,i as j,j as re,aX as ne,ap as ae,k as oe,l as P,v as cs,t as le,aY as us}from"./C2gCytJl.js";import{a as Ne,S as gt,b as ie,r as hs,s as gs}from"./ColaUvO8.js";import{_ as Ze,p as ds,i as Z,c as Ee,b as dt,r as qe}from"./DBHFiZT6.js";import{s as Y}from"./DyXzYyNk.js";import{d as ps,f as fs}from"./x9zuId2S.js";import{b as ms}from"./XQQBL9CJ.js";function ys(t,e){return e}function ws(t,e,s){for(var i=[],r=e.length,a=0;a<r;a++)ss(e[a].e,i,!0);is(i,()=>{var n=i.length===0&&s!==null;if(n){var o=s,l=o.parentNode;rs(l),l.append(o),t.items.clear(),V(t,e[0].prev,e[r-1].next)}for(var c=0;c<r;c++){var u=e[c];n||(t.items.delete(u.k),V(t,u.prev,u.next)),as(u.e,!n)}t.first===e[0]&&(t.first=e[0].prev)})}function de(t,e,s,i,r,a=null){var n=t,o={items:new Map,first:null},l=(e&ht)!==0,c=(e&ct)!==0,u=(e&lt)!==0;if(l){var h=t;n=te?we(ns(h)):h.appendChild(ke())}te&&Wt();var g=null,f=Bt(()=>{var S=s();return Ft(S)?S:S==null?[]:ot(S)}),v,R=!0;function I(){vs(m,v,o,n,e,i),g!==null&&(v.length===0?(g.fragment?(n.before(g.fragment),g.fragment=null):ut(g.effect),m.first=g.effect):es(g.effect,()=>{g=null}))}var m=Vt(()=>{v=w(f);var S=v.length;let x=!1;if(te){var D=Xt(n)===jt;D!==(S===0)&&(n=Ye(),we(n),ve(!1),x=!0)}for(var T=new Set,N=Qt,k=null,L=Yt(),E=0;E<S;E+=1){te&&ue.nodeType===Kt&&ue.data===Pt&&(n=ue,x=!0,ve(!1));var K=v[E],ee=i(K,E),O=R?null:o.items.get(ee);O?(c&&Fe(O.v,K),u?Fe(O.i,E):O.i=E,L&&N.skipped_effects.delete(O.e)):(O=bs(R?n:null,k,K,ee,E,r,e,s),R&&(O.o=!0,k===null?o.first=O:k.next=O,k=O),o.items.set(ee,O)),T.add(ee)}if(S===0&&a&&!g)if(R)g={fragment:null,effect:xe(()=>a(n))};else{var Pe=document.createDocumentFragment(),Qe=ke();Pe.append(Qe),g={fragment:Pe,effect:xe(()=>a(Qe))}}if(te&&S>0&&we(Ye()),!R)if(L){for(const[At,Mt]of o.items)T.has(At)||N.skipped_effects.add(Mt.e);N.oncommit(I),N.ondiscard(()=>{})}else I();x&&ve(!0),w(f)});R=!1,te&&(n=ue)}function vs(t,e,s,i,r,a){var n=(r&ls)!==0,o=e.length,l=s.items,c=s.first,u,h=null,g,f=[],v=[],R,I,m,S;if(n)for(S=0;S<o;S+=1)R=e[S],I=a(R,S),m=l.get(I),m.a?.measure(),(g??=new Set).add(m);for(S=0;S<o;S+=1){if(R=e[S],I=a(R,S),m=l.get(I),s.first??=m,!m.o){m.o=!0;var x=h?h.next:c;V(s,h,m),V(s,m,x),Se(m,x,i),h=m,f=[],v=[],c=h.next;continue}if((m.e.f&be)!==0&&(ut(m.e),n&&(m.a?.unfix(),(g??=new Set).delete(m))),m!==c){if(u!==void 0&&u.has(m)){if(f.length<v.length){var D=v[0],T;h=D.prev;var N=f[0],k=f[f.length-1];for(T=0;T<f.length;T+=1)Se(f[T],D,i);for(T=0;T<v.length;T+=1)u.delete(v[T]);V(s,N.prev,k.next),V(s,h,N),V(s,k,D),c=D,h=k,S-=1,f=[],v=[]}else u.delete(m),Se(m,c,i),V(s,m.prev,m.next),V(s,m,h===null?s.first:h.next),V(s,h,m),h=m;continue}for(f=[],v=[];c!==null&&c.k!==I;)(c.e.f&be)===0&&(u??=new Set).add(c),v.push(c),c=c.next;if(c===null)continue;m=c}f.push(m),h=m,c=m.next}if(c!==null||u!==void 0){for(var L=u===void 0?[]:ot(u);c!==null;)(c.e.f&be)===0&&L.push(c),c=c.next;var E=L.length;if(E>0){var K=(r&ht)!==0&&o===0?i:null;if(n){for(S=0;S<E;S+=1)L[S].a?.measure();for(S=0;S<E;S+=1)L[S].a?.fix()}ws(s,L,K)}}n&&os(()=>{if(g!==void 0)for(m of g)m.a?.apply()}),t.first=s.first&&s.first.e,t.last=h&&h.e,h&&(h.e.next=null)}function bs(t,e,s,i,r,a,n,o){var l=(n&ct)!==0,c=(n&Zt)===0,u=l?c?Jt(s,!1,!1):Je(s):s,h=(n&lt)===0?r:Je(r),g={i:h,v:u,k:i,a:null,e:null,o:!1,prev:e,next:null};try{if(t===null){var f=document.createDocumentFragment();f.append(t=ke())}return g.e=xe(()=>a(t,u,h,o)),g.e.prev=e&&e.e,e!==null&&(e.next=g,e.e.next=g.e),g}finally{}}function Se(t,e,s){for(var i=t.next?t.next.e.nodes_start:s,r=e?e.e.nodes_start:s,a=t.e.nodes_start;a!==null&&a!==i;){var n=ts(a);r.before(a),a=n}}function V(t,e,s){e===null?t.first=s:(e.next=s,e.e.next=s&&s.e),s!==null&&(s.prev=e,s.e.prev=e&&e.e)}var Oe=(t=>(t[t.Degree0=0]="Degree0",t[t.Degree90=1]="Degree90",t[t.Degree180=2]="Degree180",t[t.Degree270=3]="Degree270",t))(Oe||{});function Ss(t){return{x:Math.floor(t.x),y:Math.floor(t.y)}}function Rs(t){return{width:Math.ceil(t.width),height:Math.ceil(t.height)}}function Hr(t){return{origin:Ss(t.origin),size:Rs(t.size)}}function Ie(t){const{width:e,height:s}=t;return{width:s,height:e}}function Cs(t,e,s){return t=e%2===0?t:Ie(t),{width:t.width*s,height:t.height*s}}function Ur(t){const e=[t.p1.x,t.p2.x,t.p3.x,t.p4.x],s=[t.p1.y,t.p2.y,t.p3.y,t.p4.y];return{origin:{x:Math.min(...e),y:Math.min(...s)},size:{width:Math.max(...e)-Math.min(...e),height:Math.max(...s)-Math.min(...s)}}}function Gr(t){return{p1:{x:t.origin.x,y:t.origin.y},p2:{x:t.origin.x+t.size.width,y:t.origin.y},p3:{x:t.origin.x+t.size.width,y:t.origin.y+t.size.height},p4:{x:t.origin.x,y:t.origin.y+t.size.height}}}function Ts(t,e,s){let i=e.x,r=e.y;switch(s){case 0:i=e.x,r=e.y;break;case 1:i=t.height-e.y,r=e.x;break;case 2:i=t.width-e.x,r=t.height-e.y;break;case 3:i=e.y,r=t.width-e.x;break}return{x:i,y:r}}function Le(t,e){return{x:t.x*e,y:t.y*e}}function xs(t,e,s,i){return Le(Ts(t,e,s),i)}function ks(t,e,s){let i=e.origin.x,r=e.origin.y,a=e.size;switch(s){case 0:break;case 1:i=t.height-e.origin.y-e.size.height,r=e.origin.x,a=Ie(e.size);break;case 2:i=t.width-e.origin.x-e.size.width,r=t.height-e.origin.y-e.size.height;break;case 3:i=e.origin.y,r=t.width-e.origin.x-e.size.width,a=Ie(e.size);break}return{origin:{x:i,y:r},size:{width:a.width,height:a.height}}}function Es(t,e){return{origin:{x:t.origin.x*e,y:t.origin.y*e},size:{width:t.size.width*e,height:t.size.height*e}}}function Is(t,e,s,i){return Es(ks(t,e,s),i)}function Ar(t,e,s,i){const r=t.origin.x,a=t.origin.y,n=t.size.width,o=t.size.height,l=s/n,c=i/o,u=s/o,h=i/n;switch(e){case 0:return{a:l,b:0,c:0,d:c,e:-l*r,f:-c*a};case 3:return{a:0,b:-h,c:u,d:0,e:-u*a,f:h*(r+n)};case 2:return{a:-l,b:0,c:0,d:-c,e:l*(r+n),f:c*(a+o)};case 1:return{a:0,b:h,c:-u,d:0,e:u*(a+o),f:-h*r}}}class $e{isEnabled(){return!1}debug(){}info(){}warn(){}error(){}perf(){}}class Ls{isEnabled(){return!0}debug(e,s,...i){console.debug(`${e}.${s}`,...i)}info(e,s,...i){console.info(`${e}.${s}`,...i)}warn(e,s,...i){console.warn(`${e}.${s}`,...i)}error(e,s,...i){console.error(`${e}.${s}`,...i)}perf(e,s,i,r,...a){console.info(`${e}.${s}.${i}.${r}`,...a)}}class _s{constructor(e,s){this.logger=e,this.level=s}isEnabled(e){const s={debug:0,info:1,warn:2,error:3};return this.level<=s[e]}debug(e,s,...i){this.level<=0&&this.logger.debug(e,s,...i)}info(e,s,...i){this.level<=1&&this.logger.info(e,s,...i)}warn(e,s,...i){this.level<=2&&this.logger.warn(e,s,...i)}error(e,s,...i){this.level<=3&&this.logger.error(e,s,...i)}perf(e,s,i,r,...a){this.logger.perf(e,s,i,r,...a)}}class Ds{constructor(){}isEnabled(){return!1}debug(e,s,...i){}info(e,s,...i){}warn(e,s,...i){}error(e,s,...i){}perf(e,s,i,r,a,...n){switch(r){case"Begin":globalThis.performance.mark(`${e}.${s}.${i}.${r}.${a}`,{detail:n});break;case"End":globalThis.performance.mark(`${e}.${s}.${i}.${r}.${a}`,{detail:n}),globalThis.performance.measure(`${e}.${s}.${i}.Measure.${a}`,`${e}.${s}.${i}.Begin.${a}`,`${e}.${s}.${i}.End.${a}`);break}}}class Ns{constructor(e){this.loggers=e}isEnabled(e){return this.loggers.some(s=>s.isEnabled(e))}debug(e,s,...i){for(const r of this.loggers)r.debug(e,s,...i)}info(e,s,...i){for(const r of this.loggers)r.info(e,s,...i)}warn(e,s,...i){for(const r of this.loggers)r.warn(e,s,...i)}error(e,s,...i){for(const r of this.loggers)r.error(e,s,...i)}perf(e,s,i,r,...a){for(const n of this.loggers)n.perf(e,s,i,r,...a)}}class qs extends Error{constructor(e){super(`Task aborted: ${JSON.stringify(e)}`),this.name="TaskAbortedError",this.reason=e}}class Os extends Error{constructor(e){super(`Task rejected: ${JSON.stringify(e)}`),this.name="TaskRejectedError",this.reason=e}}class B{constructor(){this.state={stage:0},this.resolvedCallbacks=[],this.rejectedCallbacks=[],this._promise=null,this.progressCbs=[]}toPromise(){return this._promise||(this._promise=new Promise((e,s)=>{this.wait(i=>e(i),i=>{i.type==="abort"?s(new qs(i.reason)):s(new Os(i.reason))})})),this._promise}wait(e,s){switch(this.state.stage){case 0:this.resolvedCallbacks.push(e),this.rejectedCallbacks.push(s);break;case 1:e(this.state.result);break;case 2:s({type:"reject",reason:this.state.reason});break;case 3:s({type:"abort",reason:this.state.reason});break}}resolve(e){if(this.state.stage===0){this.state={stage:1,result:e};for(const s of this.resolvedCallbacks)try{s(e)}catch{}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}reject(e){if(this.state.stage===0){this.state={stage:2,reason:e};for(const s of this.rejectedCallbacks)try{s({type:"reject",reason:e})}catch{}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}abort(e){if(this.state.stage===0){this.state={stage:3,reason:e};for(const s of this.rejectedCallbacks)try{s({type:"abort",reason:e})}catch{}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}fail(e){e.type==="abort"?this.abort(e.reason):this.reject(e.reason)}onProgress(e){this.progressCbs.push(e)}progress(e){for(const s of this.progressCbs)s(e)}static all(e){const s=new B;if(e.length===0)return s.resolve([]),s;const i=new Array(e.length);let r=0,a=!1;return e.forEach((n,o)=>{n.wait(l=>{a||(i[o]=l,r++,r===e.length&&(a=!0,s.resolve(i)))},l=>{a||(a=!0,l.type==="abort"?s.abort(l.reason):s.reject(l.reason))})}),s}static allSettled(e){const s=new B;if(e.length===0)return s.resolve([]),s;const i=new Array(e.length);let r=0;return e.forEach((a,n)=>{a.wait(o=>{i[n]={status:"resolved",value:o},r++,r===e.length&&s.resolve(i)},o=>{i[n]={status:o.type==="abort"?"aborted":"rejected",reason:o.reason},r++,r===e.length&&s.resolve(i)})}),s}static race(e){const s=new B;if(e.length===0)return s.reject("No tasks provided"),s;let i=!1;return e.forEach(r=>{r.wait(a=>{i||(i=!0,s.resolve(a))},a=>{i||(i=!0,a.type==="abort"?s.abort(a.reason):s.reject(a.reason))})}),s}static withProgress(e,s){const i=B.all(e);if(s){let r=0;e.forEach(a=>{a.wait(()=>{r++,s(r,e.length)},()=>{r++,s(r,e.length)})})}return i}}const $s="­",zs="​",Hs="⁠",Us="\uFEFF",Gs="￾",As="￿",Ms=Object.freeze([$s,zs,Hs,Us,Gs,As]),Ws=new RegExp(`[${Ms.join("")}]`,"g");function Mr(t){return t.replace(Ws,"")}var Vs=(t=>(t[t.Unknown=0]="Unknown",t[t.XYZ=1]="XYZ",t[t.FitPage=2]="FitPage",t[t.FitHorizontal=3]="FitHorizontal",t[t.FitVertical=4]="FitVertical",t[t.FitRectangle=5]="FitRectangle",t[t.FitBoundingBox=6]="FitBoundingBox",t[t.FitBoundingBoxHorizontal=7]="FitBoundingBoxHorizontal",t[t.FitBoundingBoxVertical=8]="FitBoundingBoxVertical",t))(Vs||{}),Bs=(t=>(t[t.NotSet=0]="NotSet",t[t.True=1]="True",t[t.False=2]="False",t[t.Unknown=3]="Unknown",t))(Bs||{}),q=(t=>(t[t.Unknown=-1]="Unknown",t[t.Courier=0]="Courier",t[t.Courier_Bold=1]="Courier_Bold",t[t.Courier_BoldOblique=2]="Courier_BoldOblique",t[t.Courier_Oblique=3]="Courier_Oblique",t[t.Helvetica=4]="Helvetica",t[t.Helvetica_Bold=5]="Helvetica_Bold",t[t.Helvetica_BoldOblique=6]="Helvetica_BoldOblique",t[t.Helvetica_Oblique=7]="Helvetica_Oblique",t[t.Times_Roman=8]="Times_Roman",t[t.Times_Bold=9]="Times_Bold",t[t.Times_BoldItalic=10]="Times_BoldItalic",t[t.Times_Italic=11]="Times_Italic",t[t.Symbol=12]="Symbol",t[t.ZapfDingbats=13]="ZapfDingbats",t))(q||{}),pe=(t=>(t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right",t))(pe||{}),_=(t=>(t[t.Normal=0]="Normal",t[t.Multiply=1]="Multiply",t[t.Screen=2]="Screen",t[t.Overlay=3]="Overlay",t[t.Darken=4]="Darken",t[t.Lighten=5]="Lighten",t[t.ColorDodge=6]="ColorDodge",t[t.ColorBurn=7]="ColorBurn",t[t.HardLight=8]="HardLight",t[t.SoftLight=9]="SoftLight",t[t.Difference=10]="Difference",t[t.Exclusion=11]="Exclusion",t[t.Hue=12]="Hue",t[t.Saturation=13]="Saturation",t[t.Color=14]="Color",t[t.Luminosity=15]="Luminosity",t))(_||{}),Xs=(t=>(t[t.Contain=0]="Contain",t[t.Cover=1]="Cover",t[t.Stretch=2]="Stretch",t))(Xs||{}),js=(t=>(t[t.Unsupported=0]="Unsupported",t[t.Goto=1]="Goto",t[t.RemoteGoto=2]="RemoteGoto",t[t.URI=3]="URI",t[t.LaunchAppOrOpenFile=4]="LaunchAppOrOpenFile",t))(js||{}),Ks=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.TEXT=1]="TEXT",t[t.LINK=2]="LINK",t[t.FREETEXT=3]="FREETEXT",t[t.LINE=4]="LINE",t[t.SQUARE=5]="SQUARE",t[t.CIRCLE=6]="CIRCLE",t[t.POLYGON=7]="POLYGON",t[t.POLYLINE=8]="POLYLINE",t[t.HIGHLIGHT=9]="HIGHLIGHT",t[t.UNDERLINE=10]="UNDERLINE",t[t.SQUIGGLY=11]="SQUIGGLY",t[t.STRIKEOUT=12]="STRIKEOUT",t[t.STAMP=13]="STAMP",t[t.CARET=14]="CARET",t[t.INK=15]="INK",t[t.POPUP=16]="POPUP",t[t.FILEATTACHMENT=17]="FILEATTACHMENT",t[t.SOUND=18]="SOUND",t[t.MOVIE=19]="MOVIE",t[t.WIDGET=20]="WIDGET",t[t.SCREEN=21]="SCREEN",t[t.PRINTERMARK=22]="PRINTERMARK",t[t.TRAPNET=23]="TRAPNET",t[t.WATERMARK=24]="WATERMARK",t[t.THREED=25]="THREED",t[t.RICHMEDIA=26]="RICHMEDIA",t[t.XFAWIDGET=27]="XFAWIDGET",t[t.REDACT=28]="REDACT",t))(Ks||{}),Ps=(t=>(t[t.Normal=0]="Normal",t[t.Rollover=1]="Rollover",t[t.Down=2]="Down",t))(Ps||{}),Qs=(t=>(t[t.Unknown=-1]="Unknown",t[t.Comment=0]="Comment",t[t.Key=1]="Key",t[t.Note=2]="Note",t[t.Help=3]="Help",t[t.NewParagraph=4]="NewParagraph",t[t.Paragraph=5]="Paragraph",t[t.Insert=6]="Insert",t[t.Graph=7]="Graph",t[t.PushPin=8]="PushPin",t[t.Paperclip=9]="Paperclip",t[t.Tag=10]="Tag",t[t.Speaker=11]="Speaker",t[t.Mic=12]="Mic",t[t.Approved=13]="Approved",t[t.Experimental=14]="Experimental",t[t.NotApproved=15]="NotApproved",t[t.AsIs=16]="AsIs",t[t.Expired=17]="Expired",t[t.NotForPublicRelease=18]="NotForPublicRelease",t[t.Confidential=19]="Confidential",t[t.Final=20]="Final",t[t.Sold=21]="Sold",t[t.Departmental=22]="Departmental",t[t.ForComment=23]="ForComment",t[t.TopSecret=24]="TopSecret",t[t.Draft=25]="Draft",t[t.ForPublicRelease=26]="ForPublicRelease",t))(Qs||{}),Ys=(t=>(t[t.None=0]="None",t[t.Square=1]="Square",t[t.Circle=2]="Circle",t[t.Diamond=3]="Diamond",t[t.OpenArrow=4]="OpenArrow",t[t.ClosedArrow=5]="ClosedArrow",t[t.Butt=6]="Butt",t[t.ROpenArrow=7]="ROpenArrow",t[t.RClosedArrow=8]="RClosedArrow",t[t.Slash=9]="Slash",t[t.Unknown=10]="Unknown",t))(Ys||{}),Fs=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.PUSHBUTTON=1]="PUSHBUTTON",t[t.CHECKBOX=2]="CHECKBOX",t[t.RADIOBUTTON=3]="RADIOBUTTON",t[t.COMBOBOX=4]="COMBOBOX",t[t.LISTBOX=5]="LISTBOX",t[t.TEXTFIELD=6]="TEXTFIELD",t[t.SIGNATURE=7]="SIGNATURE",t[t.XFA=8]="XFA",t[t.XFA_CHECKBOX=9]="XFA_CHECKBOX",t[t.XFA_COMBOBOX=10]="XFA_COMBOBOX",t[t.XFA_IMAGEFIELD=11]="XFA_IMAGEFIELD",t[t.XFA_LISTBOX=12]="XFA_LISTBOX",t[t.XFA_PUSHBUTTON=13]="XFA_PUSHBUTTON",t[t.XFA_SIGNATURE=14]="XFA_SIGNATURE",t[t.XFA_TEXTFIELD=15]="XFA_TEXTFIELD",t))(Fs||{}),Js=(t=>(t[t.Color=0]="Color",t[t.InteriorColor=1]="InteriorColor",t))(Js||{}),Zs=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.SOLID=1]="SOLID",t[t.DASHED=2]="DASHED",t[t.BEVELED=3]="BEVELED",t[t.INSET=4]="INSET",t[t.UNDERLINE=5]="UNDERLINE",t[t.CLOUDY=6]="CLOUDY",t))(Zs||{}),ei=(t=>(t[t.UNKNOWN=0]="UNKNOWN",t[t.TEXT=1]="TEXT",t[t.PATH=2]="PATH",t[t.IMAGE=3]="IMAGE",t[t.SHADING=4]="SHADING",t[t.FORM=5]="FORM",t))(ei||{});const _e=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"}),ti=Object.entries(_e).reduce((t,[e,s])=>(t[s]=Number(e),t),{});function Wr(t){return Object.keys(_e).filter(e=>(t&e)!==0).map(e=>_e[e])}function Vr(t){return t.reduce((e,s)=>e|ti[s],0)}var si=(t=>(t[t.None=0]="None",t[t.MatchCase=1]="MatchCase",t[t.MatchWholeWord=2]="MatchWholeWord",t[t.MatchConsecutive=4]="MatchConsecutive",t))(si||{}),ii=(t=>(t[t.Display=0]="Display",t[t.Print=1]="Print",t))(ii||{}),ze=(t=>(t[t.Ok=0]="Ok",t[t.Unknown=1]="Unknown",t[t.NotFound=2]="NotFound",t[t.WrongFormat=3]="WrongFormat",t[t.Password=4]="Password",t[t.Security=5]="Security",t[t.PageError=6]="PageError",t[t.XFALoad=7]="XFALoad",t[t.XFALayout=8]="XFALayout",t[t.Cancelled=9]="Cancelled",t[t.Initialization=10]="Initialization",t[t.NotReady=11]="NotReady",t[t.NotSupport=12]="NotSupport",t[t.LoadDoc=13]="LoadDoc",t[t.DocNotOpen=14]="DocNotOpen",t[t.CantCloseDoc=15]="CantCloseDoc",t[t.CantCreateNewDoc=16]="CantCreateNewDoc",t[t.CantImportPages=17]="CantImportPages",t[t.CantCreateAnnot=18]="CantCreateAnnot",t[t.CantSetAnnotRect=19]="CantSetAnnotRect",t[t.CantSetAnnotContent=20]="CantSetAnnotContent",t[t.CantRemoveInkList=21]="CantRemoveInkList",t[t.CantAddInkStoke=22]="CantAddInkStoke",t[t.CantReadAttachmentSize=23]="CantReadAttachmentSize",t[t.CantReadAttachmentContent=24]="CantReadAttachmentContent",t[t.CantFocusAnnot=25]="CantFocusAnnot",t[t.CantSelectText=26]="CantSelectText",t[t.CantSelectOption=27]="CantSelectOption",t[t.CantCheckField=28]="CantCheckField",t[t.CantSetAnnotString=29]="CantSetAnnotString",t))(ze||{});class Br{static create(){return new B}static resolve(e){const s=new B;return s.resolve(e),s}static reject(e){const s=new B;return s.reject(e),s}static abort(e){const s=new B;return s.reject(e),s}}function Xr(t){const e=i=>Math.max(0,Math.min(255,i)),s=i=>e(i).toString(16).padStart(2,"0");return`#${s(t.red)}${s(t.green)}${s(t.blue)}`}function jr(t){/^#?[0-9a-f]{3}$/i.test(t)&&(t=t.replace(/^#?([0-9a-f])([0-9a-f])([0-9a-f])$/i,"#$1$1$2$2$3$3").toLowerCase());const[,e,s,i]=/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(t)??(()=>{throw new Error(`Invalid hex colour: "${t}"`)})();return{red:parseInt(e,16),green:parseInt(s,16),blue:parseInt(i,16)}}function Kr(t){return(s=>Math.max(0,Math.min(255,s)))(t)/255}function Pr(t){return((s,i=255)=>Math.max(0,Math.min(i,s)))(Math.round(t*255))}function Qr(t){if(!t?.startsWith("D:")||t.length<16)return;const e=+t.slice(2,6),s=+t.slice(6,8)-1,i=+t.slice(8,10),r=+t.slice(10,12),a=+t.slice(12,14),n=+t.slice(14,16);return new Date(Date.UTC(e,s,i,r,a,n))}function Yr(t=new Date){const e=(l,c=2)=>l.toString().padStart(c,"0"),s=t.getUTCFullYear(),i=e(t.getUTCMonth()+1),r=e(t.getUTCDate()),a=e(t.getUTCHours()),n=e(t.getUTCMinutes()),o=e(t.getUTCSeconds());return`D:${s}${i}${r}${a}${n}${o}`}const He=Object.freeze([{id:pe.Left,label:"Left",css:"left"},{id:pe.Center,label:"Center",css:"center"},{id:pe.Right,label:"Right",css:"right"}]);He.reduce((t,e)=>(t[e.id]=e,t),{});He.reduce((t,e)=>(t[e.css]=e.id,t),{});He.map(t=>({value:t.id,label:t.label}));var pt=(t=>(t.Courier="Courier",t.Helvetica="Helvetica",t.Times="Times",t.Symbol="Symbol",t.ZapfDingbats="ZapfDingbats",t.Unknown="Unknown",t))(pt||{});q.Helvetica;const ri={id:q.Helvetica,family:"Helvetica",bold:!1,italic:!1,label:"Helvetica",css:"Helvetica, Arial, sans-serif"},Ue=Object.freeze([{id:q.Courier,family:"Courier",bold:!1,italic:!1,label:"Courier",css:"Courier, monospace"},{id:q.Courier_Bold,family:"Courier",bold:!0,italic:!1,label:"Courier Bold",css:'"Courier-Bold", Courier, monospace'},{id:q.Courier_BoldOblique,family:"Courier",bold:!0,italic:!0,label:"Courier Bold Oblique",css:'"Courier-BoldOblique", Courier, monospace'},{id:q.Courier_Oblique,family:"Courier",bold:!1,italic:!0,label:"Courier Oblique",css:'"Courier-Oblique", Courier, monospace'},ri,{id:q.Helvetica_Bold,family:"Helvetica",bold:!0,italic:!1,label:"Helvetica Bold",css:'"Helvetica-Bold", Arial, sans-serif'},{id:q.Helvetica_BoldOblique,family:"Helvetica",bold:!0,italic:!0,label:"Helvetica Bold Oblique",css:'"Helvetica-BoldOblique", Arial, sans-serif'},{id:q.Helvetica_Oblique,family:"Helvetica",bold:!1,italic:!0,label:"Helvetica Oblique",css:'"Helvetica-Oblique", Arial, sans-serif'},{id:q.Times_Roman,family:"Times",bold:!1,italic:!1,label:"Times Roman",css:'"Times New Roman", Times, serif'},{id:q.Times_Bold,family:"Times",bold:!0,italic:!1,label:"Times Bold",css:'"Times New Roman Bold", Times, serif'},{id:q.Times_BoldItalic,family:"Times",bold:!0,italic:!0,label:"Times Bold Italic",css:'"Times New Roman Bold Italic", Times, serif'},{id:q.Times_Italic,family:"Times",bold:!1,italic:!0,label:"Times Italic",css:'"Times New Roman Italic", Times, serif'},{id:q.Symbol,family:"Symbol",bold:!1,italic:!1,label:"Symbol",css:"Symbol"},{id:q.ZapfDingbats,family:"ZapfDingbats",bold:!1,italic:!1,label:"Zapf Dingbats",css:"ZapfDingbats"}]);Ue.reduce((t,e)=>(t[e.id]=e,t),{});const ai=new Map;for(const t of Ue)ai.set(`${t.family}_${t.bold}_${t.italic}`,t.id);Object.values(pt).filter(t=>t!=="Unknown").map(t=>({value:t,label:t}));[...new Set(Ue.map(t=>t.family))];const Ge=Object.freeze([{id:_.Normal,label:"Normal",css:"normal"},{id:_.Multiply,label:"Multiply",css:"multiply"},{id:_.Screen,label:"Screen",css:"screen"},{id:_.Overlay,label:"Overlay",css:"overlay"},{id:_.Darken,label:"Darken",css:"darken"},{id:_.Lighten,label:"Lighten",css:"lighten"},{id:_.ColorDodge,label:"Color Dodge",css:"color-dodge"},{id:_.ColorBurn,label:"Color Burn",css:"color-burn"},{id:_.HardLight,label:"Hard Light",css:"hard-light"},{id:_.SoftLight,label:"Soft Light",css:"soft-light"},{id:_.Difference,label:"Difference",css:"difference"},{id:_.Exclusion,label:"Exclusion",css:"exclusion"},{id:_.Hue,label:"Hue",css:"hue"},{id:_.Saturation,label:"Saturation",css:"saturation"},{id:_.Color,label:"Color",css:"color"},{id:_.Luminosity,label:"Luminosity",css:"luminosity"}]);Ge.reduce((t,e)=>(t[e.id]=e,t),{});Ge.reduce((t,e)=>(t[e.css]=e.id,t),{});Ge.map(t=>({value:t.id,label:t.label}));function et(t){if(t instanceof $e)return{type:"noop"};if(t instanceof Ls)return{type:"console"};if(t instanceof Ds)return{type:"perf"};if(t instanceof _s){const e=t;return{type:"level",config:{level:e.level,logger:et(e.logger)}}}return t instanceof Ns?{type:"all",config:{loggers:t.loggers.map(et)}}:{type:"noop"}}const ni=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;function Fr(t){return ni.test(t)}function oi(t){var e;if(typeof((e=globalThis.crypto)==null?void 0:e.getRandomValues)=="function")return globalThis.crypto.getRandomValues(new Uint8Array(t));if(typeof require=="function")try{const{randomBytes:i}=require("crypto");return i(t)}catch{}const s=new Uint8Array(t);for(let i=0;i<t;i++)s[i]=Math.floor(Math.random()*256);return s}function Jr(){var t;if(typeof((t=globalThis.crypto)==null?void 0:t.randomUUID)=="function")return globalThis.crypto.randomUUID();const e=oi(16);e[6]=e[6]&15|64,e[8]=e[8]&63|128;const s=Array.from(e,i=>i.toString(16).padStart(2,"0")).join("");return`${s.slice(0,8)}-${s.slice(8,12)}-${s.slice(12,16)}-${s.slice(16,20)}-${s.slice(20)}`}function ft(){}const li="https://cdn.jsdelivr.net/npm/@embedpdf/pdfium@1.4.1/dist/pdfium.wasm",d="WebWorkerEngine",p="Engine";function b(t,e,s){return{id:t,type:"ExecuteRequest",data:{name:e,args:s}}}class y extends B{constructor(e,s){super(),this.worker=e,this.messageId=s}abort(e){super.abort(e),this.worker.postMessage({id:this.messageId,type:"AbortRequest"})}progress(e){super.progress(e)}}const mt=class De{constructor(e,s=new $e){this.worker=e,this.logger=s,this.tasks=new Map,this.handle=i=>{this.logger.debug(d,p,"webworker engine start handling message: ",i.data);try{const r=i.data,a=this.tasks.get(r.id);if(!a)return;switch(r.type){case"ReadyResponse":this.readyTask.resolve(!0);break;case"ExecuteProgress":a.progress(r.data);break;case"ExecuteResponse":{switch(r.data.type){case"result":a.resolve(r.data.value);break;case"error":a.reject(r.data.value.reason);break}this.tasks.delete(r.id)}break}}catch(r){this.logger.error(d,p,"webworker met error when handling message: ",r)}},this.worker.addEventListener("message",this.handle),this.readyTask=new y(this.worker,De.readyTaskId),this.tasks.set(De.readyTaskId,this.readyTask)}generateRequestId(e){return`${e}.${Date.now()}.${Math.random()}`}initialize(){this.logger.debug(d,p,"initialize");const e=this.generateRequestId("General"),s=new y(this.worker,e),i=b(e,"initialize",[]);return this.proxy(s,i),s}destroy(){this.logger.debug(d,p,"destroy");const e=this.generateRequestId("General"),s=new y(this.worker,e),i=()=>{this.worker.removeEventListener("message",this.handle),this.worker.terminate()};s.wait(i,i);const r=b(e,"destroy",[]);return this.proxy(s,r),s}openDocumentUrl(e,s){this.logger.debug(d,p,"openDocumentUrl",e.url,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"openDocumentUrl",[e,s]);return this.proxy(r,a),r}openDocumentBuffer(e,s){this.logger.debug(d,p,"openDocumentBuffer",e,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"openDocumentBuffer",[e,s]);return this.proxy(r,a),r}getMetadata(e){this.logger.debug(d,p,"getMetadata",e);const s=this.generateRequestId(e.id),i=new y(this.worker,s),r=b(s,"getMetadata",[e]);return this.proxy(i,r),i}setMetadata(e,s){this.logger.debug(d,p,"setMetadata",e,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"setMetadata",[e,s]);return this.proxy(r,a),r}getDocPermissions(e){this.logger.debug(d,p,"getDocPermissions",e);const s=this.generateRequestId(e.id),i=new y(this.worker,s),r=b(s,"getDocPermissions",[e]);return this.proxy(i,r),i}getDocUserPermissions(e){this.logger.debug(d,p,"getDocUserPermissions",e);const s=this.generateRequestId(e.id),i=new y(this.worker,s),r=b(s,"getDocUserPermissions",[e]);return this.proxy(i,r),i}getBookmarks(e){this.logger.debug(d,p,"getBookmarks",e);const s=this.generateRequestId(e.id),i=new y(this.worker,s),r=b(s,"getBookmarks",[e]);return this.proxy(i,r),i}setBookmarks(e,s){this.logger.debug(d,p,"setBookmarks",e,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"setBookmarks",[e,s]);return this.proxy(r,a),r}deleteBookmarks(e){this.logger.debug(d,p,"deleteBookmarks",e);const s=this.generateRequestId(e.id),i=new y(this.worker,s),r=b(s,"deleteBookmarks",[e]);return this.proxy(i,r),i}getSignatures(e){this.logger.debug(d,p,"getSignatures",e);const s=this.generateRequestId(e.id),i=new y(this.worker,s),r=b(s,"getSignatures",[e]);return this.proxy(i,r),i}renderPage(e,s,i){this.logger.debug(d,p,"renderPage",e,s,i);const r=this.generateRequestId(e.id),a=new y(this.worker,r),n=b(r,"renderPage",[e,s,i]);return this.proxy(a,n),a}renderPageRect(e,s,i,r){this.logger.debug(d,p,"renderPageRect",e,s,i,r);const a=this.generateRequestId(e.id),n=new y(this.worker,a),o=b(a,"renderPageRect",[e,s,i,r]);return this.proxy(n,o),n}renderPageAnnotation(e,s,i,r){this.logger.debug(d,p,"renderAnnotation",e,s,i,r);const a=this.generateRequestId(e.id),n=new y(this.worker,a),o=b(a,"renderPageAnnotation",[e,s,i,r]);return this.proxy(n,o),n}getAllAnnotations(e){this.logger.debug(d,p,"getAllAnnotations",e);const s=this.generateRequestId(e.id),i=new y(this.worker,s),r=b(s,"getAllAnnotations",[e]);return this.proxy(i,r),i}getPageAnnotations(e,s){this.logger.debug(d,p,"getPageAnnotations",e,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"getPageAnnotations",[e,s]);return this.proxy(r,a),r}createPageAnnotation(e,s,i,r){this.logger.debug(d,p,"createPageAnnotations",e,s,i,r);const a=this.generateRequestId(e.id),n=new y(this.worker,a),o=b(a,"createPageAnnotation",[e,s,i,r]);return this.proxy(n,o),n}updatePageAnnotation(e,s,i){this.logger.debug(d,p,"updatePageAnnotation",e,s,i);const r=this.generateRequestId(e.id),a=new y(this.worker,r),n=b(r,"updatePageAnnotation",[e,s,i]);return this.proxy(a,n),a}removePageAnnotation(e,s,i){this.logger.debug(d,p,"removePageAnnotations",e,s,i);const r=this.generateRequestId(e.id),a=new y(this.worker,r),n=b(r,"removePageAnnotation",[e,s,i]);return this.proxy(a,n),a}getPageTextRects(e,s){this.logger.debug(d,p,"getPageTextRects",e,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"getPageTextRects",[e,s]);return this.proxy(r,a),r}renderThumbnail(e,s,i){this.logger.debug(d,p,"renderThumbnail",e,s,i);const r=this.generateRequestId(e.id),a=new y(this.worker,r),n=b(r,"renderThumbnail",[e,s,i]);return this.proxy(a,n),a}searchAllPages(e,s,i){this.logger.debug(d,p,"searchAllPages",e,s,i);const r=this.generateRequestId(e.id),a=new y(this.worker,r),n=b(r,"searchAllPages",[e,s,i]);return this.proxy(a,n),a}saveAsCopy(e){this.logger.debug(d,p,"saveAsCopy",e);const s=this.generateRequestId(e.id),i=new y(this.worker,s),r=b(s,"saveAsCopy",[e]);return this.proxy(i,r),i}getAttachments(e){this.logger.debug(d,p,"getAttachments",e);const s=this.generateRequestId(e.id),i=new y(this.worker,s),r=b(s,"getAttachments",[e]);return this.proxy(i,r),i}addAttachment(e,s){this.logger.debug(d,p,"addAttachment",e,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"addAttachment",[e,s]);return this.proxy(r,a),r}removeAttachment(e,s){this.logger.debug(d,p,"removeAttachment",e,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"removeAttachment",[e,s]);return this.proxy(r,a),r}readAttachmentContent(e,s){this.logger.debug(d,p,"readAttachmentContent",e,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"readAttachmentContent",[e,s]);return this.proxy(r,a),r}setFormFieldValue(e,s,i,r){this.logger.debug(d,p,"setFormFieldValue",e,i,r);const a=this.generateRequestId(e.id),n=new y(this.worker,a),o=b(a,"setFormFieldValue",[e,s,i,r]);return this.proxy(n,o),n}flattenPage(e,s,i){this.logger.debug(d,p,"flattenPage",e,s,i);const r=this.generateRequestId(e.id),a=new y(this.worker,r),n=b(r,"flattenPage",[e,s,i]);return this.proxy(a,n),a}extractPages(e,s){this.logger.debug(d,p,"extractPages",e);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"extractPages",[e,s]);return this.proxy(r,a),r}redactTextInRects(e,s,i,r){this.logger.debug(d,p,"redactTextInRects",e,s,i,r);const a=this.generateRequestId(e.id),n=new y(this.worker,a),o=b(a,"redactTextInRects",[e,s,i,r]);return this.proxy(n,o),n}extractText(e,s){this.logger.debug(d,p,"extractText",e);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"extractText",[e,s]);return this.proxy(r,a),r}getTextSlices(e,s){this.logger.debug(d,p,"getTextSlices",e,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"getTextSlices",[e,s]);return this.proxy(r,a),r}getPageGlyphs(e,s){this.logger.debug(d,p,"getPageGlyphs",e,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"getPageGlyphs",[e,s]);return this.proxy(r,a),r}getPageGeometry(e,s){this.logger.debug(d,p,"getPageGeometry",e,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"getPageGeometry",[e,s]);return this.proxy(r,a),r}merge(e){this.logger.debug(d,p,"merge",e);const s=e.map(n=>n.id).join("."),i=this.generateRequestId(s),r=new y(this.worker,i),a=b(i,"merge",[e]);return this.proxy(r,a),r}mergePages(e){this.logger.debug(d,p,"mergePages",e);const s=this.generateRequestId(e.map(a=>a.docId).join(".")),i=new y(this.worker,s),r=b(s,"mergePages",[e]);return this.proxy(i,r),i}preparePrintDocument(e,s){this.logger.debug(d,p,"preparePrintDocument",e,s);const i=this.generateRequestId(e.id),r=new y(this.worker,i),a=b(i,"preparePrintDocument",[e,s]);return this.proxy(r,a),r}closeDocument(e){this.logger.debug(d,p,"closeDocument",e);const s=this.generateRequestId(e.id),i=new y(this.worker,s),r=b(s,"closeDocument",[e]);return this.proxy(i,r),i}closeAllDocuments(){this.logger.debug(d,p,"closeAllDocuments");const e=this.generateRequestId("closeAllDocuments"),s=new y(this.worker,e),i=b(e,"closeAllDocuments",[]);return this.proxy(s,i),s}proxy(e,s,i=[]){this.logger.debug(d,p,"send request to worker",e,s,i),this.logger.perf(d,p,`${s.data.name}`,"Begin",s.id),this.readyTask.wait(()=>{this.worker.postMessage(s,i),e.wait(()=>{this.logger.perf(d,p,`${s.data.name}`,"End",s.id)},()=>{this.logger.perf(d,p,`${s.data.name}`,"End",s.id)}),this.tasks.set(s.id,e)},()=>{this.logger.perf(d,p,`${s.data.name}`,"End",s.id),e.reject({code:ze.Initialization,message:"worker initialization failed"})})}};mt.readyTaskId="0";let Zr=mt;function ci(t){const{wasmUrl:e=li,worker:s=!0,logger:i}={},r=F({engine:null,isLoading:!0,error:null});let a=J(null);return typeof window<"u"&&A(()=>{let o=!1;return(async()=>{try{const{createPdfiumEngine:l}=s?await Ze(()=>import("./DTK3-6hx.js"),[],import.meta.url):await Ze(()=>import("./uw6f9mv8.js"),[],import.meta.url),c=await l(e,i);Q(a,c,!0),c.initialize().wait(()=>{r.engine=c,r.isLoading=!1},u=>{r.error=new Error(u.reason.message),r.isLoading=!1})}catch(l){o||(r.error=l,r.isLoading=!1)}})(),()=>{var l,c;o=!0,(c=(l=w(a))==null?void 0:l.closeAllDocuments)==null||c.call(l).wait(()=>{var u,h;(h=(u=w(a))==null?void 0:u.destroy)==null||h.call(u),Q(a,null)},ft)}}),r}class tt{constructor(){this.dependencyGraph=new Map}addNode(e,s=[]){this.dependencyGraph.set(e,new Set(s))}hasCircularDependencies(){const e=new Set,s=new Set,i=r=>{e.add(r),s.add(r);const a=this.dependencyGraph.get(r)||new Set;for(const n of a)if(e.has(n)){if(s.has(n))return!0}else if(i(n))return!0;return s.delete(r),!1};for(const r of this.dependencyGraph.keys())if(!e.has(r)&&i(r))return!0;return!1}resolveLoadOrder(){if(this.hasCircularDependencies())throw new Error("Circular dependencies detected");const e=[],s=new Set,i=new Set,r=a=>{if(i.has(a))throw new Error("Circular dependency");if(s.has(a))return;i.add(a);const n=this.dependencyGraph.get(a)||new Set;for(const o of n)r(o);i.delete(a),s.add(a),e.push(a)};for(const a of this.dependencyGraph.keys())s.has(a)||r(a);return e}}class z extends Error{constructor(e){super(e),this.name="PluginRegistrationError"}}class se extends Error{constructor(e){super(e),this.name="PluginNotFoundError"}}class ui extends Error{constructor(e){super(e),this.name="CircularDependencyError"}}class hi extends Error{constructor(e){super(e),this.name="PluginConfigurationError"}}class gi{constructor(e,s){this.store=e,this.pluginId=s}getState(){return this.store.getState().plugins[this.pluginId]}dispatch(e){return this.store.dispatchToPlugin(this.pluginId,e)}subscribeToState(e){return this.store.subscribeToPlugin(this.pluginId,(s,i,r)=>{e(s,i,r)})}onAction(e,s){return this.store.onAction(e,(i,r,a)=>{s(i,r.plugins[this.pluginId],a.plugins[this.pluginId])})}}const Ae="LOAD_DOCUMENT",yt="REFRESH_DOCUMENT",di="REFRESH_PAGES",fe="SET_DOCUMENT",wt="SET_DOCUMENT_ERROR",Me="SET_SCALE",We="SET_ROTATION",Ve="SET_PAGES",pi=[Ae,yt,fe,wt,Me,We,Ve],fi=()=>({type:Ae}),mi=t=>({type:fe,payload:t});class yi{constructor(e,s){this.initialCoreState=s,this.pluginReducers={},this.listeners=[],this.pluginListeners={},this.isDispatching=!1,this.state={core:s,plugins:{}},this.coreReducer=e}addPluginReducer(e,s,i){this.state.plugins[e]=i,this.pluginReducers[e]=s}dispatchToCore(e){if(!this.coreReducer)return this.getState();if(this.isDispatching)throw new Error("Reducers may not dispatch actions. To trigger cascading actions, dispatch from a listener callback instead.");const s=this.getState();try{this.isDispatching=!0,this.state.core=this.coreReducer(this.state.core,e)}finally{this.isDispatching=!1}return this.listeners.forEach(i=>{const r=this.getState();i(e,r,s)}),this.getState()}dispatchToPlugin(e,s,i=!0){if(this.isDispatching)throw new Error("Reducers may not dispatch actions. To trigger cascading actions, dispatch from a listener callback instead.");const r=this.getState(),a=this.pluginReducers[e];if(!a)return r.plugins[e];const n=r.plugins[e];try{this.isDispatching=!0;const o=a(n,s);this.state.plugins[e]=o}finally{this.isDispatching=!1}return i&&this.listeners.forEach(o=>{const l=this.getState();o(s,l,r)}),this.pluginListeners[e]&&this.pluginListeners[e].forEach(o=>{const l=this.getState().plugins[e];o(s,l,n)}),this.getState().plugins[e]}dispatch(e){if(this.isDispatching)throw new Error("Reducers may not dispatch actions. To trigger cascading actions, dispatch from a listener callback instead.");const s=this.getState();try{this.isDispatching=!0,this.isCoreAction(e)&&(this.state.core=this.coreReducer(this.state.core,e));for(const i in this.pluginReducers){const r=this.pluginReducers[i],a=s.plugins[i];r&&(this.state.plugins[i]=r(a,e))}}finally{this.isDispatching=!1}return this.listeners.forEach(i=>{const r=this.getState();i(e,r,s)}),this.getState()}getState(){if(this.isDispatching)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return{core:{...this.state.core},plugins:{...this.state.plugins}}}subscribe(e){if(this.isDispatching)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state.");return this.listeners.push(e),()=>{if(this.isDispatching)throw new Error("You may not unsubscribe from a store listener while the reducer is executing.");this.listeners=this.listeners.filter(s=>s!==e)}}subscribeToPlugin(e,s){if(!(e in this.state.plugins))throw new Error(`Plugin state not found for plugin "${e}". Did you forget to call addPluginReducer?`);if(this.isDispatching)throw new Error("You may not call store.subscribeToPlugin() while the reducer is executing.");return this.pluginListeners[e]||(this.pluginListeners[e]=[]),this.pluginListeners[e].push(s),()=>{if(this.isDispatching)throw new Error("You may not unsubscribe from a store listener while the reducer is executing.");this.pluginListeners[e]=this.pluginListeners[e].filter(i=>i!==s),this.pluginListeners[e].length===0&&delete this.pluginListeners[e]}}onAction(e,s){return this.subscribe((i,r,a)=>{i.type===e&&s(i,r,a)})}getPluginStore(e){if(!(e in this.state.plugins))throw new Error(`Plugin state not found for plugin "${e}". Did you forget to call addPluginReducer?`);return new gi(this,e)}isCoreAction(e){return pi.includes(e.type)}destroy(){var e,s;this.listeners.length=0;for(const i in this.pluginListeners)(s=(e=this.pluginListeners[i])==null?void 0:e.splice)==null||s.call(e,0);this.pluginListeners={},this.pluginReducers={},this.state.plugins={},this.state.core={...this.initialCoreState}}}const wi=t=>({scale:t?.scale??1,rotation:t?.rotation??Oe.Degree0,document:null,pages:[],loading:!1,error:null}),he=t=>t.pages.map(e=>e.map(s=>({...s,rotatedSize:Cs(s.size,t.rotation,1)}))),vi=(t,e)=>{switch(e.type){case Ae:return{...t,loading:!0,error:null};case fe:return{...t,document:e.payload,pages:e.payload.pages.map(s=>[s]),loading:!1,error:null};case yt:return{...t,document:e.payload,pages:e.payload.pages.map(s=>[s]),loading:!1,error:null};case We:return{...t,rotation:e.payload};case Ve:return{...t,pages:e.payload};case wt:return{...t,loading:!1,error:e.payload};case Me:return{...t,scale:e.payload};default:return t}};class bi{constructor(e,s){this.plugins=new Map,this.manifests=new Map,this.capabilities=new Map,this.status=new Map,this.configurations=new Map,this.engineInitialized=!1,this.initPromise=null,this.pendingRegistrations=[],this.processingRegistrations=[],this.initialized=!1,this.isInitializing=!1,this.pluginsReadyPromise=null,this.destroyed=!1,this.resolver=new tt,this.engine=e,this.initialCoreState=wi(s),this.store=new yi(vi,this.initialCoreState),this.logger=s?.logger??new $e}getLogger(){return this.logger}async ensureEngineInitialized(){this.engineInitialized||(this.engine.initialize?(await this.engine.initialize().toPromise(),this.engineInitialized=!0):this.engineInitialized=!0)}registerPlugin(e,s){if(this.initialized&&!this.isInitializing)throw new z("Cannot register plugins after initialization");this.validateManifest(e.manifest),this.store.addPluginReducer(e.manifest.id,e.reducer,typeof e.initialState=="function"?e.initialState(this.initialCoreState,{...e.manifest.defaultConfig,...s}):e.initialState),this.pendingRegistrations.push({package:e,config:s})}getStore(){return this.store}getEngine(){return this.engine}pluginsReady(){return this.pluginsReadyPromise?this.pluginsReadyPromise:(this.pluginsReadyPromise=(async()=>{this.initialized||await this.initialize();const e=Array.from(this.plugins.values()).map(s=>typeof s.ready=="function"?s.ready():Promise.resolve());await Promise.all(e)})(),this.pluginsReadyPromise)}async initialize(){if(this.destroyed)throw new z("Registry has been destroyed");return this.initPromise?this.initPromise:(this.initPromise=(async()=>{var e;if(this.initialized)throw new z("Registry is already initialized");this.isInitializing=!0;try{if(await this.ensureEngineInitialized(),this.destroyed)return;for(;this.pendingRegistrations.length>0;){if(this.destroyed)return;this.processingRegistrations=[...this.pendingRegistrations],this.pendingRegistrations=[];for(const i of this.processingRegistrations){const r=new Set,a=[...i.package.manifest.requires,...i.package.manifest.optional];for(const n of a){const o=this.processingRegistrations.find(l=>l.package.manifest.provides.includes(n));o&&r.add(o.package.manifest.id)}this.resolver.addNode(i.package.manifest.id,[...r])}const s=this.resolver.resolveLoadOrder();for(const i of s){const r=this.processingRegistrations.find(a=>a.package.manifest.id===i);await this.initializePlugin(r.package.manifest,r.package.create,r.config)}this.processingRegistrations=[],this.resolver=new tt}for(const s of this.plugins.values())await((e=s.postInitialize)==null?void 0:e.call(s).catch(i=>{console.error(`Error in postInitialize for plugin ${s.id}`,i),this.status.set(s.id,"error")}));this.initialized=!0}catch(s){throw s instanceof Error?new ui(`Failed to resolve plugin dependencies: ${s.message}`):s}finally{this.isInitializing=!1}})(),this.initPromise)}async initializePlugin(e,s,i){const r={...e.defaultConfig,...i};this.validateConfig(e.id,r,e.defaultConfig);const a=s(this,r);this.validatePlugin(a);for(const n of e.requires)if(!this.capabilities.has(n))throw new z(`Missing required capability: ${n} for plugin ${e.id}`);for(const n of e.optional)this.capabilities.has(n)&&this.logger.debug("PluginRegistry","OptionalCapability",`Optional capability ${n} is available for plugin ${e.id}`);this.logger.debug("PluginRegistry","InitializePlugin",`Initializing plugin ${e.id}`,{provides:e.provides});for(const n of e.provides){if(this.capabilities.has(n))throw new z(`Capability ${n} is already provided by plugin ${this.capabilities.get(n)}`);this.capabilities.set(n,e.id)}this.plugins.set(e.id,a),this.manifests.set(e.id,e),this.status.set(e.id,"registered"),this.configurations.set(e.id,r);try{a.initialize&&await a.initialize(r),this.status.set(e.id,"active"),this.logger.info("PluginRegistry","PluginInitialized",`Plugin ${e.id} initialized successfully`)}catch(n){throw this.plugins.delete(e.id),this.manifests.delete(e.id),this.logger.error("PluginRegistry","InitializationFailed",`Plugin ${e.id} initialization failed`,{provides:e.provides,error:n}),e.provides.forEach(o=>this.capabilities.delete(o)),n}}getPluginConfig(e){const s=this.configurations.get(e);if(!s)throw new se(`Configuration for plugin ${e} not found`);return s}validateConfig(e,s,i){const a=Object.keys(i).filter(n=>!s.hasOwnProperty(n));if(a.length>0)throw new hi(`Missing required configuration keys for plugin ${e}: ${a.join(", ")}`)}async updatePluginConfig(e,s){const i=this.getPlugin(e);if(!i)throw new se(`Plugin ${e} not found`);const r=this.manifests.get(e),a=this.configurations.get(e);if(!r||!a)throw new se(`Plugin ${e} not found`);const n={...a,...s};this.validateConfig(e,n,r.defaultConfig),this.configurations.set(e,n),i.initialize&&await i.initialize(n)}registerPluginBatch(e){for(const s of e)this.registerPlugin(s.package,s.config)}async unregisterPlugin(e){const s=this.plugins.get(e);if(!s)throw new se(`Plugin ${e} is not registered`);const i=this.manifests.get(e);if(!i)throw new se(`Manifest for plugin ${e} not found`);for(const[r,a]of this.manifests.entries()){if(r===e)continue;if([...a.requires,...a.optional].some(o=>i.provides.includes(o)))throw new z(`Cannot unregister plugin ${e}: plugin ${r} depends on it`)}try{s.destroy&&await s.destroy();for(const r of i.provides)this.capabilities.delete(r);this.plugins.delete(e),this.manifests.delete(e),this.status.delete(e)}catch(r){throw r instanceof Error?new Error(`Failed to unregister plugin ${e}: ${r.message}`):r}}getPlugin(e){const s=this.plugins.get(e);return s||null}getCapabilityProvider(e){const s=this.capabilities.get(e);return s?this.getPlugin(s):null}hasCapability(e){return this.capabilities.has(e)}getAllPlugins(){return Array.from(this.plugins.values())}getPluginStatus(e){const s=this.status.get(e);if(!s)throw new se(`Plugin ${e} not found`);return s}validatePlugin(e){if(!e.id)throw new z("Plugin must have an id")}validateManifest(e){if(!e.id)throw new z("Manifest must have an id");if(!e.name)throw new z("Manifest must have a name");if(!e.version)throw new z("Manifest must have a version");if(!Array.isArray(e.provides))throw new z("Manifest must have a provides array");if(!Array.isArray(e.requires))throw new z("Manifest must have a requires array");if(!Array.isArray(e.optional))throw new z("Manifest must have an optional array")}isDestroyed(){return this.destroyed}async destroy(){var e;if(this.destroyed)throw new z("Registry has already been destroyed");this.destroyed=!0;try{await this.initPromise}catch{}for(const s of Array.from(this.plugins.values()).reverse())await((e=s.destroy)==null?void 0:e.call(s));this.store.destroy(),this.plugins.clear(),this.manifests.clear(),this.capabilities.clear(),this.status.clear(),this.pendingRegistrations.length=0,this.processingRegistrations.length=0}}function ge(t,e){return{package:t,config:e}}function Si(t){return"autoMountElements"in t&&typeof t.autoMountElements=="function"}class me{constructor(e,s){if(this.id=e,this.registry=s,this.cooldownActions={},this.debouncedTimeouts={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.engine=this.registry.getEngine(),this.logger=this.registry.getLogger(),this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((i,r,a)=>{this.onStoreUpdated(a,r)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((i,r,a)=>{this.onCoreStoreUpdated(a,r)}),this.readyPromise=new Promise(i=>{this.readyResolve=i}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}cooldownDispatch(e,s=100){const i=Date.now(),r=this.cooldownActions[e.type]||0;return i-r>=s?(this.cooldownActions[e.type]=i,this.dispatch(e),!0):!1}debouncedDispatch(e,s=100){const i=e.type;this.debouncedTimeouts[i]&&clearTimeout(this.debouncedTimeouts[i]),this.debouncedTimeouts[i]=setTimeout(()=>{this.dispatch(e),delete this.debouncedTimeouts[i]},s)}cancelDebouncedDispatch(e){this.debouncedTimeouts[e]&&(clearTimeout(this.debouncedTimeouts[e]),delete this.debouncedTimeouts[e])}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,s){}onCoreStoreUpdated(e,s){}destroy(){Object.values(this.debouncedTimeouts).forEach(e=>{clearTimeout(e)}),this.debouncedTimeouts={},this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}}class Ri{constructor(e,s){this.handler=e,this.options=s,this.lastRun=0,this.handle=i=>{this.options.mode==="debounce"?this.debounce(i):this.throttle(i)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if(this.options.mode==="debounce")return;const s=Date.now(),i=this.options.throttleMode||"leading-trailing";s-this.lastRun>=this.options.wait&&(i==="leading-trailing"&&this.handler(e),this.lastRun=s),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(s-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}}function ce(t,e,s){if(t===e)return!0;if(t==null||e==null)return t===e;const i=typeof t;if(i!==typeof e)return!1;if(i==="object"){s||(s=new Set);const a=Ci(t,e);if(s.has(a))return!0;s.add(a);const n=Array.isArray(t),o=Array.isArray(e);return n&&o?xi(t,e,s):!n&&!o?ki(t,e,s):!1}return!1}function Ci(t,e){return`${st(t)}__${st(e)}`}let Ti=0;const Re=new WeakMap;function st(t){return Re.has(t)||Re.set(t,++Ti),Re.get(t)}function xi(t,e,s){if(t.length!==e.length)return!1;const i=new Array(e.length).fill(!1);e:for(let r=0;r<t.length;r++){const a=t[r];for(let n=0;n<e.length;n++)if(!i[n]&&ce(a,e[n],s)){i[n]=!0;continue e}return!1}return!0}function ki(t,e,s){const i=Object.keys(t).sort(),r=Object.keys(e).sort();if(i.length!==r.length)return!1;for(let a=0;a<i.length;a++)if(i[a]!==r[a])return!1;for(const a of i){const n=t[a],o=e[a];if(!ce(n,o,s))return!1}return!0}function Be(){const t=new Set;return{emit:(s=void 0)=>t.forEach(i=>i(s)),on:s=>(t.add(s),()=>t.delete(s)),off:s=>t.delete(s),clear:()=>t.clear()}}function G(t,e=ce){const s=new Set,i=new Map;let r=t;const a=o=>s.forEach(l=>l(o)),n=(o,l)=>{let c=o,u=()=>{};if(l){const h=new Ri(o,l);c=h.handle,u=()=>h.destroy(),i.set(o,{wrapped:c,destroy:u})}return r!==void 0&&c(r),s.add(c),()=>{s.delete(c),u(),i.delete(o)}};return{get value(){return r},emit(o=void 0){(r===void 0||!e(r,o))&&(r=o,a(o))},on:n,off(o){const l=i.get(o);l?(s.delete(l.wrapped),l.destroy(),i.delete(o)):s.delete(o)},clear(){s.clear(),i.forEach(o=>o.destroy()),i.clear()},select(o,l=ce){return(c,u)=>{let h;if(r!==void 0){const g=o(r);h=g,c(g)}return n(g=>{const f=o(g);(h===void 0||!l(h,f))&&(h=f,c(f))},u)}}}}class Ei{constructor(e){this.autoMountElements=[],this.package=e}addUtility(e){return this.autoMountElements.push({component:e,type:"utility"}),this}addWrapper(e){return this.autoMountElements.push({component:e,type:"wrapper"}),this}build(){return{...this.package,autoMountElements:()=>this.autoMountElements}}}function Ii(t){return new Ei(t)}const M=F({registry:null,isInitializing:!0,pluginsReady:!1}),Li=()=>M;function ye(t){const{registry:e}=M,s=F({plugin:null,isLoading:!0,ready:new Promise(()=>{})});if(e===null)return s;const i=e.getPlugin(t);if(!i)throw new Error(`Plugin ${t} not found`);return s.plugin=i,s.isLoading=!1,s.ready=i.ready(),s}function Xe(t){const e=ye(t),s=F({provides:null,isLoading:!0,ready:new Promise(()=>{})});return A(()=>{if(!e.plugin){s.provides=null,s.isLoading=e.isLoading,s.ready=e.ready;return}if(!e.plugin.provides)throw new Error(`Plugin ${t} does not provide a capability`);s.provides=e.plugin.provides(),s.isLoading=e.isLoading,s.ready=e.ready}),s}function _i(){const{registry:t}=Li(),e=F({coreState:null});return A(()=>{if(!t)return;const s=t.getStore();return e.coreState=s.getState().core,s.subscribe((i,r,a)=>{s.isCoreAction(i)&&!ce(r.core,a.core)&&(e.coreState=r.core)})}),e}function vt(t,e){X(e,!0);var s=U(),i=$(s);{var r=n=>{const o=ae(()=>e.wrappers[0]);var l=U(),c=$(l);Ee(c,()=>w(o),(u,h)=>{h(u,{children:(g,f)=>{{let v=ae(()=>e.wrappers.slice(1));vt(g,{get wrappers(){return w(v)},children:(R,I)=>{var m=U(),S=$(m);Y(S,()=>e.children??ne),C(R,m)},$$slots:{default:!0}})}},$$slots:{default:!0}})}),C(n,l)},a=n=>{const o=ae(()=>e.wrappers[0]);var l=U(),c=$(l);Ee(c,()=>w(o),(u,h)=>{h(u,{children:(g,f)=>{var v=U(),R=$(v);Y(R,()=>e.children??ne),C(g,v)},$$slots:{default:!0}})}),C(n,l)};Z(i,n=>{e.wrappers.length>1?n(r):n(a,!1)})}C(t,s),j()}var Di=W("<!> <!>",1);function Ni(t,e){X(e,!0);let s=J(F([])),i=J(F([]));A(()=>{var c;const u=[],h=[];for(const g of e.plugins){const f=g.package;if(Si(f)){const v=((c=f.autoMountElements)==null?void 0:c.call(f))??[];for(const R of v)R.type==="utility"?u.push(R.component):R.type==="wrapper"&&h.push(R.component)}}Q(s,u,!0),Q(i,h,!0)});var r=Di(),a=$(r);{var n=c=>{vt(c,{get wrappers(){return w(i)},get children(){return e.children}})},o=c=>{var u=U(),h=$(u);Y(h,()=>e.children??ne),C(c,u)};Z(a,c=>{w(i).length>0?c(n):c(o,!1)})}var l=re(a,2);de(l,19,()=>w(s),(c,u)=>`utility-${u}`,(c,u)=>{var h=U(),g=$(h);Ee(g,()=>w(u),(f,v)=>{v(f,{})}),C(c,h)}),C(t,r),j()}function qi(t,e){X(e,!0);let s=ds(e,"autoMountDomElements",3,!0),i=e.onInitialized;A(()=>{e.onInitialized&&(i=e.onInitialized)}),A(()=>{if(e.engine||e.engine&&e.plugins){const l=new bi(e.engine,{logger:e.logger});return l.registerPluginBatch(e.plugins),(async()=>{await l.initialize(),!l.isDestroyed()&&(await i?.(l),!l.isDestroyed()&&(l.pluginsReady().then(()=>{l.isDestroyed()||(M.pluginsReady=!0)}),M.registry=l,M.isInitializing=!1))})().catch(console.error),()=>{l.destroy(),M.registry=null,M.isInitializing=!1,M.pluginsReady=!1}}});var r=U(),a=$(r);{var n=l=>{Ni(l,{get plugins(){return e.plugins},children:(c,u)=>{var h=U(),g=$(h);Y(g,()=>e.children,()=>M),C(c,h)},$$slots:{default:!0}})},o=l=>{var c=U(),u=$(c);Y(u,()=>e.children,()=>M),C(l,c)};Z(a,l=>{M.pluginsReady&&s()?l(n):l(o,!1)})}C(t,r),j()}const bt="viewport",Oi={id:bt,name:"Viewport Plugin",version:"1.0.0",provides:["viewport"],requires:[],optional:[],defaultConfig:{enabled:!0,viewportGap:10,scrollEndDelay:300}},St="SET_VIEWPORT_METRICS",Rt="SET_VIEWPORT_SCROLL_METRICS",Ct="SET_VIEWPORT_GAP",Tt="SET_SCROLL_ACTIVITY",xt="SET_SMOOTH_SCROLL_ACTIVITY";function $i(t){return{type:Ct,payload:t}}function zi(t){return{type:St,payload:t}}function Hi(t){return{type:Rt,payload:t}}function Ui(t){return{type:Tt,payload:t}}function it(t){return{type:xt,payload:t}}const kt={viewportGap:0,viewportMetrics:{width:0,height:0,scrollTop:0,scrollLeft:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0,relativePosition:{x:0,y:0}},isScrolling:!1,isSmoothScrolling:!1},Gi=(t=kt,e)=>{switch(e.type){case Ct:return{...t,viewportGap:e.payload};case St:return{...t,viewportMetrics:{width:e.payload.width,height:e.payload.height,scrollTop:e.payload.scrollTop,scrollLeft:e.payload.scrollLeft,clientWidth:e.payload.clientWidth,clientHeight:e.payload.clientHeight,scrollWidth:e.payload.scrollWidth,scrollHeight:e.payload.scrollHeight,relativePosition:{x:e.payload.scrollWidth<=e.payload.clientWidth?0:e.payload.scrollLeft/(e.payload.scrollWidth-e.payload.clientWidth),y:e.payload.scrollHeight<=e.payload.clientHeight?0:e.payload.scrollTop/(e.payload.scrollHeight-e.payload.clientHeight)}}};case Rt:return{...t,viewportMetrics:{...t.viewportMetrics,scrollTop:e.payload.scrollTop,scrollLeft:e.payload.scrollLeft},isScrolling:!0};case Tt:return{...t,isScrolling:e.payload};case xt:return{...t,isSmoothScrolling:e.payload};default:return t}},Et=class extends me{constructor(e,s,i){super(e,s),this.id=e,this.viewportResize$=G(),this.viewportMetrics$=G(),this.scrollMetrics$=G(),this.scrollReq$=Be(),this.scrollActivity$=G(),this.rectProvider=null,i.viewportGap&&this.dispatch($i(i.viewportGap)),this.scrollEndDelay=i.scrollEndDelay||100}buildCapability(){return{getViewportGap:()=>this.state.viewportGap,getMetrics:()=>this.state.viewportMetrics,getBoundingRect:()=>{var e;return((e=this.rectProvider)==null?void 0:e.call(this))??{origin:{x:0,y:0},size:{width:0,height:0}}},scrollTo:e=>this.scrollTo(e),isScrolling:()=>this.state.isScrolling,isSmoothScrolling:()=>this.state.isSmoothScrolling,onScrollChange:this.scrollMetrics$.on,onViewportChange:this.viewportMetrics$.on,onViewportResize:this.viewportResize$.on,onScrollActivity:this.scrollActivity$.on}}setViewportResizeMetrics(e){this.registry.isDestroyed()||(this.dispatch(zi(e)),this.viewportResize$.emit(this.state.viewportMetrics))}setViewportScrollMetrics(e){this.registry.isDestroyed()||(e.scrollTop!==this.state.viewportMetrics.scrollTop||e.scrollLeft!==this.state.viewportMetrics.scrollLeft)&&(this.dispatch(Hi(e)),this.bumpScrollActivity(),this.scrollMetrics$.emit({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}))}onScrollRequest(e){return this.scrollReq$.on(e)}registerBoundingRectProvider(e){this.rectProvider=e}bumpScrollActivity(){this.debouncedDispatch(Ui(!1),this.scrollEndDelay),this.debouncedDispatch(it(!1),this.scrollEndDelay)}scrollTo(e){const{x:s,y:i,center:r,behavior:a="auto"}=e;if(a==="smooth"&&this.dispatch(it(!0)),r){const n=this.state.viewportMetrics,o=s-n.clientWidth/2,l=i-n.clientHeight/2;this.scrollReq$.emit({x:o,y:l,behavior:a})}else this.scrollReq$.emit({x:s,y:i,behavior:a})}emitScrollActivity(){const e={isSmoothScrolling:this.state.isSmoothScrolling,isScrolling:this.state.isScrolling};this.scrollActivity$.emit(e)}onStoreUpdated(e,s){e!==s&&(this.viewportMetrics$.emit(s.viewportMetrics),(e.isScrolling!==s.isScrolling||e.isSmoothScrolling!==s.isSmoothScrolling)&&this.emitScrollActivity())}async initialize(e){}async destroy(){super.destroy(),this.viewportMetrics$.clear(),this.viewportResize$.clear(),this.scrollMetrics$.clear(),this.scrollReq$.clear(),this.scrollActivity$.clear(),this.rectProvider=null}};Et.id="viewport";let je=Et;const Ai={manifest:Oi,create:(t,e)=>new je(bt,t,e),reducer:Gi,initialState:kt},Mi=()=>ye(je.id),Wi=()=>Xe(je.id);function Vi(){const{plugin:t}=Mi();let e=J(null);return cs(()=>{if(!t)return;const s=w(e);if(!s)return;const i=()=>{const o=s.getBoundingClientRect();return{origin:{x:o.left,y:o.top},size:{width:o.width,height:o.height}}};t.registerBoundingRectProvider(i);const r=()=>{t?.setViewportScrollMetrics({scrollTop:s.scrollTop,scrollLeft:s.scrollLeft})};s.addEventListener("scroll",r);const a=new ResizeObserver(()=>{t?.setViewportResizeMetrics({width:s.offsetWidth,height:s.offsetHeight,clientWidth:s.clientWidth,clientHeight:s.clientHeight,scrollTop:s.scrollTop,scrollLeft:s.scrollLeft,scrollWidth:s.scrollWidth,scrollHeight:s.scrollHeight})});a.observe(s);const n=t.onScrollRequest(({x:o,y:l,behavior:c="auto"})=>{requestAnimationFrame(()=>{s.scrollTo({left:o,top:l,behavior:c})})});return()=>{t?.registerBoundingRectProvider(null),s.removeEventListener("scroll",r),a.disconnect(),n()}}),{get containerRef(){return w(e)},set containerRef(s){Q(e,s,!0)}}}var Bi=W("<div><!></div>");function Xi(t,e){X(e,!0);let s=qe(e,["$$slots","$$events","$$legacy","children","class"]),i=J(0),r=Vi();const a=Wi();A(()=>{a.provides&&Q(i,a.provides.getViewportGap(),!0)});var n=Bi();Ne(n,l=>({...s,class:e.class,[gt]:l}),[()=>({width:"100%",height:"100%",overflow:"auto",padding:`${w(i)}px`})]);var o=oe(n);Y(o,()=>e.children),P(n),dt(n,l=>r.containerRef=l,()=>r?.containerRef),C(t,n),j()}var H=(t=>(t.Vertical="vertical",t.Horizontal="horizontal",t))(H||{});class It{constructor(e){this.pageGap=e.pageGap??20,this.viewportGap=e.viewportGap??20,this.bufferSize=e.bufferSize??2}getVisibleRange(e,s,i){const r=this.getScrollOffset(e),a=this.getClientSize(e),n=r,o=r+a;let l=0;for(;l<s.length&&(s[l].offset+s[l].height)*i<=n;)l++;let c=l;for(;c<s.length&&s[c].offset*i<=o;)c++;return{start:Math.max(0,l-this.bufferSize),end:Math.min(s.length-1,c+this.bufferSize-1)}}handleScroll(e,s,i){const r=this.getVisibleRange(e,s,i),a=s.slice(r.start,r.end+1),n=this.calculatePageVisibility(a,e,i),o=n.map(v=>v.pageNumber),l=s.slice(r.start,r.end+1).flatMap(v=>v.index),c=this.determineCurrentPage(n),u=s[r.start],h=s[r.end],g=u?u.offset*i:0,f=h?(s[s.length-1].offset+s[s.length-1].height)*i-(h.offset+h.height)*i:0;return{currentPage:c,visiblePages:o,pageVisibilityMetrics:n,renderedPageIndexes:l,scrollOffset:{x:e.scrollLeft,y:e.scrollTop},startSpacing:g,endSpacing:f}}calculatePageVisibility(e,s,i){const r=[];return e.forEach(a=>{a.pageLayouts.forEach(n=>{const o=a.x*i,l=a.y*i,c=o+n.x*i,u=l+n.y*i,h=n.rotatedWidth*i,g=n.rotatedHeight*i,f=s.scrollLeft,v=s.scrollTop,R=f+s.clientWidth,I=v+s.clientHeight,m=Math.max(c,f),S=Math.max(u,v),x=Math.min(c+h,R),D=Math.min(u+g,I);if(m<x&&S<D){const T=x-m,N=D-S,k=h*g,L=T*N;r.push({pageNumber:n.pageNumber,viewportX:m-f,viewportY:S-v,visiblePercentage:L/k*100,original:{pageX:(m-c)/i,pageY:(S-u)/i,visibleWidth:T/i,visibleHeight:N/i,scale:1},scaled:{pageX:m-c,pageY:S-u,visibleWidth:T,visibleHeight:N,scale:i}})}})}),r}determineCurrentPage(e){if(e.length===0)return 1;const s=Math.max(...e.map(r=>r.visiblePercentage)),i=e.filter(r=>r.visiblePercentage===s);return i.length===1?i[0].pageNumber:i.sort((r,a)=>r.pageNumber-a.pageNumber)[0].pageNumber}getRectLocationForPage(e,s,i){const r=s.find(o=>o.pageNumbers.includes(e));if(!r)return null;const a=r.pageLayouts.find(o=>o.pageNumber===e);if(!a)return null;let n=0;if(i){const o=i.width;r.width<o&&(n=(o-r.width)/2)}return{origin:{x:r.x+a.x+n,y:r.y+a.y},size:{width:a.width,height:a.height}}}getScrollPositionForPage(e,s,i,r,a){const n=this.getTotalContentSize(s),o=this.getRectLocationForPage(e,s,n);if(!o)return null;const l=Le(o.origin,i);if(a){const c=xs({width:o.size.width,height:o.size.height},{x:a.x,y:a.y},r,i);return{x:l.x+c.x+this.viewportGap,y:l.y+c.y+this.viewportGap}}return{x:l.x+this.viewportGap,y:l.y+this.viewportGap}}getRectPositionForPage(e,s,i,r,a){const n=this.getTotalContentSize(s),o=this.getRectLocationForPage(e,s,n);if(!o)return null;const l=Le(o.origin,i),c=Is({width:o.size.width,height:o.size.height},a,r,i);return{origin:{x:l.x+c.origin.x,y:l.y+c.origin.y},size:c.size}}}class Ce extends It{constructor(e){super(e)}createVirtualItems(e){let s=0;return e.map((i,r)=>{let a=0;const n=i.map(u=>{const h={pageNumber:u.index+1,pageIndex:u.index,x:a,y:0,width:u.size.width,height:u.size.height,rotatedWidth:u.rotatedSize.width,rotatedHeight:u.rotatedSize.height};return a+=u.rotatedSize.width+this.pageGap,h}),o=i.reduce((u,h,g)=>u+h.rotatedSize.width+(g<i.length-1?this.pageGap:0),0),l=Math.max(...i.map(u=>u.rotatedSize.height)),c={id:`item-${r}`,x:0,y:s,offset:s,width:o,height:l,pageLayouts:n,pageNumbers:i.map(u=>u.index+1),index:r};return s+=l+this.pageGap,c})}getTotalContentSize(e){if(e.length===0)return{width:0,height:0};const s=Math.max(...e.map(r=>r.width)),i=e[e.length-1].y+e[e.length-1].height;return{width:s,height:i}}getScrollOffset(e){return e.scrollTop}getClientSize(e){return e.clientHeight}}class Te extends It{constructor(e){super(e)}createVirtualItems(e){let s=0;return e.map((i,r)=>{let a=0;const n=i.map(u=>{const h={pageNumber:u.index+1,pageIndex:u.index,x:a,y:0,width:u.size.width,height:u.size.height,rotatedWidth:u.rotatedSize.width,rotatedHeight:u.rotatedSize.height};return a+=u.rotatedSize.width+this.pageGap,h}),o=i.reduce((u,h,g)=>u+h.rotatedSize.width+(g<i.length-1?this.pageGap:0),0),l=Math.max(...i.map(u=>u.rotatedSize.height)),c={id:`item-${r}`,x:s,y:0,offset:s,width:o,height:l,pageLayouts:n,pageNumbers:i.map(u=>u.index+1),index:r};return s+=o+this.pageGap,c})}getTotalContentSize(e){if(e.length===0)return{width:0,height:0};const s=e[e.length-1].x+e[e.length-1].width,i=Math.max(...e.map(r=>r.height));return{width:s,height:i}}getScrollOffset(e){return e.scrollLeft}getClientSize(e){return e.clientWidth}}const Lt="UPDATE_SCROLL_STATE",ji="SET_DESIRED_SCROLL_POSITION",_t="UPDATE_TOTAL_PAGES",Dt="SET_PAGE_CHANGE_STATE";function rt(t){return{type:Lt,payload:t}}function Ki(t){return{type:_t,payload:t}}function at(t){return{type:Dt,payload:t}}const Pi=(t,e)=>({startSpacing:t.startSpacing,endSpacing:t.endSpacing,totalWidth:t.totalContentSize.width*e,totalHeight:t.totalContentSize.height*e,pageGap:t.pageGap*e,strategy:t.strategy,items:t.renderedPageIndexes.map(s=>({...t.virtualItems[s],pageLayouts:t.virtualItems[s].pageLayouts.map(i=>({...i,rotatedWidth:i.rotatedWidth*e,rotatedHeight:i.rotatedHeight*e,width:i.width*e,height:i.height*e}))}))}),Nt=class extends me{constructor(e,s,i){var r,a,n,o;super(e,s),this.id=e,this.config=i,this.currentScale=1,this.currentRotation=Oe.Degree0,this.currentPage=1,this.layoutReady=!1,this.pageChangeState$=G(),this.layout$=G(),this.scroll$=G(),this.state$=G(),this.scrollerLayout$=G(),this.pageChange$=G(),this.layoutReady$=G(),this.viewport=this.registry.getPlugin("viewport").provides(),this.strategyConfig={pageGap:((r=this.config)==null?void 0:r.pageGap)??10,viewportGap:this.viewport.getViewportGap(),bufferSize:((a=this.config)==null?void 0:a.bufferSize)??2},this.strategy=((n=this.config)==null?void 0:n.strategy)===H.Horizontal?new Te(this.strategyConfig):new Ce(this.strategyConfig),this.initialPage=(o=this.config)==null?void 0:o.initialPage,this.currentScale=this.coreState.core.scale,this.currentRotation=this.coreState.core.rotation,this.viewport.onScrollActivity(l=>{this.state.pageChangeState.isChanging&&!l.isSmoothScrolling&&this.completePageChange()}),this.viewport.onViewportChange(l=>this.commitMetrics(this.computeMetrics(l)),{mode:"throttle",wait:100}),this.coreStore.onAction(fe,(l,c)=>{const u=c.core.pages.length;this.dispatch(Ki(u)),this.pageChange$.emit({pageNumber:this.currentPage,totalPages:u}),this.refreshAll(he(c.core),this.viewport.getMetrics())}),this.coreStore.onAction(We,(l,c)=>this.refreshAll(he(c.core),this.viewport.getMetrics())),this.coreStore.onAction(Ve,(l,c)=>this.refreshAll(he(c.core),this.viewport.getMetrics()))}startPageChange(e,s="smooth"){const i={isChanging:!0,targetPage:e,fromPage:this.currentPage,startTime:Date.now()};this.dispatch(at(i)),s==="instant"&&this.completePageChange()}completePageChange(){if(!this.state.pageChangeState.isChanging)return;const e={isChanging:!1,targetPage:this.state.pageChangeState.targetPage,fromPage:this.state.pageChangeState.fromPage,startTime:this.state.pageChangeState.startTime};this.dispatch(at(e))}computeLayout(e){const s=this.strategy.createVirtualItems(e),i=this.strategy.getTotalContentSize(s);return{virtualItems:s,totalContentSize:i}}computeMetrics(e,s=this.state.virtualItems){return this.strategy.handleScroll(e,s,this.currentScale)}commit(e,s){this.dispatch(rt(e)),s?.layout&&this.layout$.emit(s.layout),s?.metrics&&(this.scroll$.emit(s.metrics),s.metrics.currentPage!==this.currentPage&&(this.currentPage=s.metrics.currentPage,this.pageChange$.emit({pageNumber:this.currentPage,totalPages:this.state.totalPages}))),this.scrollerLayout$.emit(this.getScrollerLayout())}commitMetrics(e){this.commit(e,{metrics:e})}refreshAll(e,s){const i=this.computeLayout(e),r=this.computeMetrics(s,i.virtualItems);this.commit({...i,...r},{layout:i,metrics:r})}getVirtualItemsFromState(){return this.state.virtualItems||[]}onScrollerData(e){return this.scrollerLayout$.on(e)}getScrollerLayout(){const e=this.coreState.core.scale;return Pi(this.state,e)}pushScrollLayout(){this.scrollerLayout$.emit(this.getScrollerLayout())}onStoreUpdated(e,s){this.pushScrollLayout(),e.pageChangeState!==s.pageChangeState&&this.pageChangeState$.emit(s.pageChangeState)}onCoreStoreUpdated(e,s){e.core.scale!==s.core.scale&&(this.currentScale=s.core.scale,this.commitMetrics(this.computeMetrics(this.viewport.getMetrics()))),e.core.rotation!==s.core.rotation&&(this.currentRotation=s.core.rotation)}setScrollStrategy(e){if(e===H.Horizontal&&this.strategy instanceof Te||e===H.Vertical&&this.strategy instanceof Ce)return;this.strategy=e===H.Horizontal?new Te(this.strategyConfig):new Ce(this.strategyConfig),this.dispatch(rt({strategy:e}));const s=he(this.coreState.core);this.refreshAll(s,this.viewport.getMetrics())}setLayoutReady(){this.layoutReady||(this.layoutReady=!0,this.layoutReady$.emit(!0),this.initialPage&&this.scrollToPage({pageNumber:this.initialPage,behavior:"instant"}))}buildCapability(){return{onStateChange:this.state$.on,onLayoutChange:this.layout$.on,onScroll:this.scroll$.on,onPageChange:this.pageChange$.on,onLayoutReady:this.layoutReady$.on,onPageChangeState:this.pageChangeState$.on,getCurrentPage:()=>this.currentPage,getTotalPages:()=>this.state.totalPages,getPageChangeState:()=>this.state.pageChangeState,scrollToPage:this.scrollToPage.bind(this),scrollToNextPage:this.scrollToNextPage.bind(this),scrollToPreviousPage:this.scrollToPreviousPage.bind(this),getMetrics:this.getMetrics.bind(this),getLayout:this.getLayout.bind(this),getRectPositionForPage:this.getRectPositionForPage.bind(this),getPageGap:()=>this.state.pageGap,setScrollStrategy:e=>this.setScrollStrategy(e)}}scrollToPage(e){const{pageNumber:s,behavior:i="smooth",pageCoordinates:r,center:a=!1}=e;this.startPageChange(s,i);const n=this.getVirtualItemsFromState(),o=this.strategy.getScrollPositionForPage(s,n,this.currentScale,this.currentRotation,r);o?this.viewport.scrollTo({...o,behavior:i,center:a}):this.completePageChange()}scrollToNextPage(e="smooth"){const s=this.getVirtualItemsFromState(),i=s.findIndex(r=>r.pageNumbers.includes(this.currentPage));if(i>=0&&i<s.length-1){const r=s[i+1],a=r.pageNumbers[0];this.startPageChange(a,e);const n=this.strategy.getScrollPositionForPage(r.pageNumbers[0],s,this.currentScale,this.currentRotation);n?this.viewport.scrollTo({...n,behavior:e}):this.completePageChange()}}scrollToPreviousPage(e="smooth"){const s=this.getVirtualItemsFromState(),i=s.findIndex(r=>r.pageNumbers.includes(this.currentPage));if(i>0){const r=s[i-1],a=r.pageNumbers[0];this.startPageChange(a,e);const n=this.strategy.getScrollPositionForPage(r.pageNumbers[0],s,this.currentScale,this.currentRotation);n?this.viewport.scrollTo({...n,behavior:e}):this.completePageChange()}}getMetrics(e){const s=e||this.viewport.getMetrics(),i=this.getVirtualItemsFromState();return this.strategy.handleScroll(s,i,this.currentScale)}getLayout(){return{virtualItems:this.state.virtualItems,totalContentSize:this.state.totalContentSize}}getRectPositionForPage(e,s,i,r){return this.strategy.getRectPositionForPage(e+1,this.state.virtualItems,i??this.currentScale,r??this.currentRotation,s)}async initialize(){}async destroy(){this.layout$.clear(),this.scroll$.clear(),this.pageChange$.clear(),this.state$.clear(),this.scrollerLayout$.clear(),this.layoutReady$.clear(),this.pageChangeState$.clear(),super.destroy()}};Nt.id="scroll";let qt=Nt;const Ot="scroll",Qi={id:Ot,name:"Scroll Plugin",version:"1.0.0",provides:["scroll"],requires:["viewport"],optional:[],defaultConfig:{enabled:!0,pageGap:10}},Yi={currentPage:1,visiblePages:[],pageVisibilityMetrics:[],renderedPageIndexes:[],scrollOffset:{x:0,y:0},startSpacing:0,endSpacing:0},Fi={isChanging:!1,targetPage:1,fromPage:1,startTime:0},Ji=(t,e)=>({virtualItems:[],totalPages:t.pages.length,totalContentSize:{width:0,height:0},desiredScrollPosition:{x:0,y:0},strategy:e.strategy??H.Vertical,pageGap:e.pageGap??10,scale:t.scale,pageChangeState:Fi,...Yi}),Zi=(t,e)=>{switch(e.type){case _t:return{...t,totalPages:e.payload};case Me:return{...t,scale:e.payload};case Lt:return{...t,...e.payload};case ji:return{...t,desiredScrollPosition:e.payload};case Dt:return{...t,pageChangeState:e.payload};default:return t}},er={manifest:Qi,create:(t,e)=>new qt(Ot,t,e),reducer:Zi,initialState:(t,e)=>Ji(t,e)},tr=()=>ye(qt.id);var sr=W("<div><!></div>"),ir=W("<div></div>"),rr=W("<div><div></div> <div></div> <div></div> <!></div>");function ar(t,e){X(e,!0);const s=tr(),i=_i();let r=ae(()=>{var c;return((c=s.plugin)==null?void 0:c.getScrollerLayout())??null}),a=qe(e,["$$slots","$$events","$$legacy","RenderPageSnippet","overlayElements"]);A(()=>{if(s.plugin)return s.plugin.onScrollerData(c=>Q(r,c))}),A(()=>{s.plugin&&s.plugin.setLayoutReady()});var n=U(),o=$(n);{var l=c=>{var u=rr();Ne(u,x=>({...a,[gt]:x}),[()=>({width:`${w(r).totalWidth}px`,height:`${w(r).totalHeight}px`,position:"relative","box-sizing":"border-box",margin:"0 auto",display:w(r).strategy===H.Horizontal?"flex":null,"flex-direction":w(r).strategy===H.Horizontal?"row":null})]);var h=oe(u);let g;var f=re(h,2);let v;de(f,21,()=>w(r).items,x=>x.pageNumbers[0],(x,D)=>{var T=ir();let N;de(T,21,()=>w(D).pageLayouts,k=>k.pageNumber,(k,L)=>{var E=sr();let K;var ee=oe(E);{let O=ae(()=>({...w(L),rotation:i.coreState.rotation,scale:i.coreState.scale,document:i.coreState.document}));Y(ee,()=>e.RenderPageSnippet??ne,()=>w(O))}P(E),le(O=>K=ie(E,"",K,O),[()=>({width:`${w(L).rotatedWidth}px`,height:`${w(L).rotatedHeight}px`})]),C(k,E)}),P(T),le(k=>N=ie(T,"",N,k),[()=>({display:"flex","justify-content":"center",gap:`${w(r).pageGap}px`})]),C(x,T)}),P(f);var R=re(f,2);let I;var m=re(R,2);{var S=x=>{var D=U(),T=$(D);de(T,17,()=>e.overlayElements,ys,(N,k)=>{var L=U(),E=$(L);Y(E,()=>w(k)??ne),C(N,L)}),C(x,D)};Z(m,x=>{e.overlayElements&&e.overlayElements.length>0&&x(S)})}P(u),le((x,D,T)=>{g=ie(h,"",g,x),v=ie(f,"",v,D),I=ie(R,"",I,T)},[()=>({width:w(r).strategy===H.Horizontal?`${w(r).startSpacing}px`:"100%",height:w(r).strategy===H.Horizontal?"100%":`${w(r).startSpacing}px`,"flex-shrink":"0"}),()=>({gap:`${w(r).pageGap}px`,display:"flex","align-items":"center",position:"relative","box-sizing":"border-box","flex-direction":w(r).strategy===H.Horizontal?"row":"column","min-width":w(r).strategy===H.Horizontal?"100%":"fit-content"}),()=>({width:w(r).strategy===H.Horizontal?`${w(r).endSpacing}px`:"100%",height:w(r).strategy===H.Horizontal?"100%":`${w(r).endSpacing}px`,"flex-shrink":"0"})]),C(c,u)};Z(o,c=>{w(r)&&i.coreState&&c(l)})}C(t,n),j()}class nr{async load(e){const{pdfFile:s,options:i,engine:r}=e,a=r.openDocumentUrl(s,i);return new Promise((n,o)=>{a.wait(l=>n(l),l=>{l.type==="abort"?o(new Error(`PDF loading aborted: ${l.reason}`)):o(new Error(`PDF loading failed: ${l.reason}`))})})}}class or{async load(e){const{pdfFile:s,options:i,engine:r}=e,a=r.openDocumentBuffer(s,i);return new Promise((n,o)=>{a.wait(l=>n(l),l=>{l.type==="abort"?o(new Error(`PDF loading aborted: ${l.reason}`)):o(new Error(`PDF loading failed: ${l.reason}`))})})}}class lr{constructor(){this.strategies=new Map,this.strategyResolvers=[];const e=new or;this.registerStrategy("url",new nr),this.registerStrategy("buffer",e),this.addStrategyResolver(s=>cr(s)?this.strategies.get("url"):this.strategies.get("buffer"))}registerStrategy(e,s){this.strategies.set(e,s)}getStrategy(e){return this.strategies.get(e)}addStrategyResolver(e){this.strategyResolvers.push(e)}async loadDocument(e){try{const s=this.resolveStrategy(e);if(!s)throw new Error("No suitable strategy found for the given options");return await s.load(e)}catch(s){throw console.error("Error loading document:",s),s}}resolveStrategy(e){for(const s of this.strategyResolvers){const i=s(e);if(i)return i}}}function cr(t){return t.type==="url"}const $t=class extends me{constructor(e,s){super(e,s),this.id=e,this.loaderHandlers$=G(),this.documentLoadedHandlers$=G(),this.openFileRequest$=Be(),this.documentLoader=new lr}buildCapability(){return{onLoaderEvent:this.loaderHandlers$.on,onDocumentLoaded:this.documentLoadedHandlers$.on,onOpenFileRequest:this.openFileRequest$.on,openFileDialog:()=>this.openFileRequest$.emit("open"),loadDocument:e=>this.loadDocument(e),registerStrategy:(e,s)=>this.documentLoader.registerStrategy(e,s),getDocument:()=>this.loadedDocument,addStrategyResolver:e=>this.documentLoader.addStrategyResolver(e)}}async initialize(e){e.defaultStrategies&&Object.entries(e.defaultStrategies).forEach(([s,i])=>{this.documentLoader.registerStrategy(s,i)}),e.loadingOptions&&(this.loadingOptions=e.loadingOptions)}async postInitialize(){this.loadingOptions&&await this.loadDocument(this.loadingOptions)}async loadDocument(e){try{this.loadedDocument&&this.engine.closeDocument(this.loadedDocument),this.loaderHandlers$.emit({type:"start",documentId:e.pdfFile.id}),this.dispatchCoreAction(fi());const s=await this.documentLoader.loadDocument({...e,engine:this.engine});return this.dispatchCoreAction(mi(s)),this.loadedDocument=s,this.loaderHandlers$.emit({type:"complete",documentId:e.pdfFile.id}),this.documentLoadedHandlers$.emit(s),s}catch(s){const i={type:"error",documentId:e.pdfFile.id,error:s instanceof Error?s:new Error(String(s))};throw this.loaderHandlers$.emit(i),s}}async destroy(){this.loaderHandlers$.clear(),this.documentLoadedHandlers$.clear(),this.openFileRequest$.clear(),super.destroy()}};$t.id="loader";let zt=$t;const Ht="loader",ur={id:Ht,name:"Loader Plugin",version:"1.0.0",provides:["loader"],requires:[],optional:[],metadata:{name:"Loader Plugin",description:"A plugin for loading PDF documents",version:"1.0.0",author:"EmbedPDF",license:"MIT"},defaultConfig:{enabled:!0}},hr={manifest:ur,create:t=>new zt(Ht,t),reducer:()=>{},initialState:{}},gr=()=>Xe(zt.id);async function dr(t,e){var s;const r=(s=t.target.files)==null?void 0:s[0],a=e.provides;if(r&&a){const n=await r.arrayBuffer();await a.loadDocument({type:"buffer",pdfFile:{id:Math.random().toString(36).substring(2,15),name:r.name,content:n}})}}var pr=W('<input type="file" accept="application/pdf" style="display: none"/>');function fr(t,e){X(e,!0);const s=gr();let i=null;A(()=>{if(!s.provides)return;const a=s.provides.onOpenFileRequest(n=>{n==="open"&&i&&i.click()});return()=>{a()}});var r=pr();r.__change=[dr,s],dt(r,a=>i=a,()=>i),C(t,r),j()}ps(["change"]);const mr=Ii(hr).addUtility(fr).build(),Ut=class extends me{constructor(e,s){super(e,s),this.refreshPages$=Be(),this.coreStore.onAction(di,i=>{this.refreshPages$.emit(i.payload)})}async initialize(e){}buildCapability(){return{renderPage:this.renderPage.bind(this),renderPageRect:this.renderPageRect.bind(this)}}onRefreshPages(e){return this.refreshPages$.on(e)}renderPage({pageIndex:e,options:s}){const i=this.coreState.core;if(!i.document)throw new Error("document does not open");const r=i.document.pages.find(a=>a.index===e);if(!r)throw new Error("page does not exist");return this.engine.renderPage(i.document,r,s)}renderPageRect({pageIndex:e,rect:s,options:i}){const r=this.coreState.core;if(!r.document)throw new Error("document does not open");const a=r.document.pages.find(n=>n.index===e);if(!a)throw new Error("page does not exist");return this.engine.renderPageRect(r.document,a,s,i)}};Ut.id="render";let Ke=Ut;const Gt="render",yr={id:Gt,name:"Render Plugin",version:"1.0.0",provides:["render"],requires:[],optional:[],defaultConfig:{enabled:!0}},wr={manifest:yr,create:t=>new Ke(Gt,t),reducer:()=>{},initialState:{}},vr=()=>ye(Ke.id),br=()=>Xe(Ke.id);var Sr=W("<img/>");function Rr(t,e){X(e,!0);let s=qe(e,["$$slots","$$events","$$legacy","pageIndex","scale","dpr","class"]);const i=br(),r=vr(),a=ae(()=>e.scale??1);let n=J(null),o=null,l=J(0);A(()=>{if(r.plugin)return r.plugin.onRefreshPages(f=>{f.includes(e.pageIndex)&&us(l)})}),A(()=>{w(l);const f=i.provides;if(!f)return;const v=f.renderPage({pageIndex:e.pageIndex,options:{scaleFactor:w(a),dpr:e.dpr||window.devicePixelRatio}});return v.wait(R=>{const I=URL.createObjectURL(R);o&&URL.revokeObjectURL(o),Q(n,I,!0),o=I},ft),()=>{o?(URL.revokeObjectURL(o),o=null):v.abort({code:ze.Cancelled,message:"canceled render task"})}});function c(){o&&(URL.revokeObjectURL(o),o=null)}var u=U(),h=$(u);{var g=f=>{var v=Sr();Ne(v,()=>({src:w(n),onload:c,...s,style:"width: 100%; height: 100%;",class:e.class,alt:""})),fs(v),C(f,v)};Z(h,f=>{w(n)&&f(g)})}C(t,u),j()}const Cr=(t,e=ne)=>{var s=Tr();let i;var r=oe(s);Rr(r,{get pageIndex(){return e().pageIndex}}),P(s),le(()=>i=ie(s,"",i,{width:`${e().width??""}px`,height:`${e().height??""}px`,position:"relative"})),C(t,s)};var Tr=W("<div><!></div>"),xr=W('<div class="loading-pane svelte-jb02kb">Loading PDF Engine...</div>'),kr=W('<div style="height: 100%; border: 1px solid black;"><!></div>');function Er(t,e){X(e,!1);const s=ci(),i=[ge(mr,{loadingOptions:{type:"url",pdfFile:{id:"HMS-pdf",url:`${window.location.origin}${ms}/test.pdf`}}}),ge(Ai),ge(er),ge(wr)];nt();var r=kr(),a=oe(r);{var n=l=>{var c=xr();C(l,c)},o=l=>{qi(l,{get engine(){return s.engine},get plugins(){return i},children:(c,u)=>{Xi(c,{class:"viewport-class",children:(h,g)=>{ar(h,{get RenderPageSnippet(){return Cr}})},$$slots:{default:!0}})},$$slots:{default:!0}})};Z(a,l=>{s.isLoading||!s.engine?l(n):l(o,!1)})}P(r),C(t,r),j()}var Ir=W('<div class="flex h-full flex-col"><h1 class="text-lg font-bold">1. Les HMS introduksjonen</h1> <!> <a class="m-1 inline-flex items-center justify-center self-start rounded-lg bg-blue-600 px-4 py-2 font-medium text-white hover:bg-blue-700">Jeg bekrefter å ha lest og forstått informasjonen over</a></div>');function ra(t,e){X(e,!1),nt();var s=Ir(),i=re(oe(s),2);Er(i,{});var r=re(i,2);P(s),le(a=>gs(r,"href",a),[()=>hs("/register")]),C(t,s),j()}export{Ps as A,Hr as B,Is as C,Ar as D,Vs as E,js as F,Pr as G,si as M,$e as N,Br as P,Oe as R,B as T,Zr as W,ra as _,ze as a,Fr as b,Ks as c,ii as d,Mr as e,Qs as f,Zs as g,Js as h,ft as i,Ys as j,Xs as k,Bs as l,Xr as m,Kr as n,Yr as o,Qr as p,Ur as q,Gr as r,et as s,q as t,Jr as u,ei as v,jr as w,Wr as x,Vr as y,Fs as z};
